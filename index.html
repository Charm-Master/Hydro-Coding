<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Source Coding Challenges</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        header {
            background: #007BFF;
            color: #fff;
            padding: 10px 20px;
            text-align: center;
        }

        nav {
            margin: 20px 0;
        }

        nav a {
            margin: 0 15px;
            color: #fff;
            text-decoration: none;
        }

        nav a:hover {
            text-decoration: underline;
        }

        .container {
            width: 80%;
            margin: auto;
            overflow: hidden;
        }

        h2 {
            color: #007BFF;
        }

        .challenge {
            background: #fff;
            border: 1px solid #ccc;
            margin: 20px 0;
            padding: 20px;
            border-radius: 5px;
        }

        .challenge h3 {
            margin: 0;
        }

        footer {
            text-align: center;
            padding: 10px 0;
            background: #007BFF;
            color: #fff;
            position: relative;
            bottom: 0;
            width: 100%;
        }

        .submission {
            margin-top: 20px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
        }

        .submission textarea {
            width: 100%;
            height: 60px;
            margin-top: 10px;
        }

        .submission button {
            margin-top: 10px;
        }

        .admin {
            margin-top: 20px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
        }

        .admin h3 {
            margin-top: 0;
        }

        .admin-table {
            width: 100%;
            margin-top: 10px;
        }

        .admin-table th,
        .admin-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }

        .approved {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .rejected {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .user-info img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .delete-btn {
            color: red;
            cursor: pointer;
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <header>
        <h1>Open Source Coding Challenges</h1>
        <nav>
            <a href="#challenges">Challenges</a>
            <a href="#profile">Profile</a>
            <a href="#admin" id="adminNav" style="display: none;">Admin</a>
        </nav>
    </header>

    <div class="container">
        <section id="challenges">
            <h2>Coding Challenges</h2>

            <div class="challenge">
                <h3>Challenge 1: FizzBuzz</h3>
                <p>Write a program that prints the numbers from 1 to 100. But for multiples of three print "Fizz"
                    instead of the number and for the multiples of five print "Buzz". For numbers which are multiples
                    of both three and five print "FizzBuzz".</p>
                <div class="submission">
                    <h4>Submit Your Solution</h4>
                    <textarea id="solution1" placeholder="Enter your solution..."></textarea>
                    <button onclick="submitSolution('FizzBuzz', 1)">Submit Solution</button>
                </div>
                <h4>Approved Solutions:</h4>
                <div id="approvedSolutions1"></div>
            </div>

            <div class="challenge">
                <h3>Challenge 2: Palindrome Checker</h3>
                <p>Write a function that checks if a given string is a palindrome. A palindrome is a word, phrase,
                    number, or other sequence of characters that reads the same forward and backward (ignoring spaces,
                    punctuation, and capitalization).</p>
                <div class="submission">
                    <h4>Submit Your Solution</h4>
                    <textarea id="solution2" placeholder="Enter your solution..."></textarea>
                    <button onclick="submitSolution('Palindrome Checker', 2)">Submit Solution</button>
                </div>
                <h4>Approved Solutions:</h4>
                <div id="approvedSolutions2"></div>
            </div>

            <div class="challenge">
                <h3>Challenge 3: Factorial</h3>
                <p>Write a function that returns the factorial of a number. The factorial of a non-negative integer n is
                    the product of all positive integers less than or equal to n.</p>
                <div class="submission">
                    <h4>Submit Your Solution</h4>
                    <textarea id="solution3" placeholder="Enter your solution..."></textarea>
                    <button onclick="submitSolution('Factorial', 3)">Submit Solution</button>
                </div>
                <h4>Approved Solutions:</h4>
                <div id="approvedSolutions3"></div>
            </div>
        </section>

        <section id="profile">
            <h2>Your Profile</h2>
            <div class="profile">
                <div class="signin">
                    <button onclick="signInWithDiscord()">Sign in with Discord</button>
                </div>
                <h3>User Profile Information</h3>
                <p id="userInfo" style="display: none;"></p>
                <div id="userChallenges" style="display: none;"></div>
            </div>
        </section>

        <section id="admin" style="display: none;">
            <h2>Admin Panel</h2>
            <div class="admin">
                <h3>Pending Submissions</h3>
                <table class="admin-table">
                    <tr>
                        <th>Challenge</th>
                        <th>Submission</th>
                        <th>Action</th>
                    </tr>
                    <tbody id="pendingSubmissions"></tbody>
                </table>
                <h3>Manage Challenges</h3>
                <button onclick="createChallenge()">Create Challenge</button>
            </div>
        </section>
    </div>

    <footer>
        <p>Open Source Coding Challenges ¬© 2024</p>
    </footer>

    <script>
        const clientId = '1300918650026594335'; // Your Discord Client ID
        const redirectUri = 'https://charm-master.github.io/Hydro-Coding'; // Your redirect URL
        let isAdmin = false;
        let userName = '';
        let userPfp = ''; // Variable to store user's profile picture URL
        const adminUserName = 'hydraulic_bolt_46520'; // Admin username

        function signInWithDiscord() {
            // Redirect to Discord's OAuth2 authorization endpoint
            window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=token&scope=identify%20email`;
        }

        function submitSolution(challengeName, challengeId) {
            const solutionTextarea = document.getElementById(`solution${challengeId}`);
            const approvedSolutionsDiv = document.getElementById(`approvedSolutions${challengeId}`);
            const submission = solutionTextarea.value;

            if (submission.trim() === '') {
                alert('Please enter a solution before submitting.');
                return;
            }

            // Display pending submission for admin approval
            const pendingSubmissionsTable = document.getElementById('pendingSubmissions');
            const row = document.createElement('tr');
            row.innerHTML = `<td>${challengeName}</td><td>${submission}</td><td><button onclick="approveSubmission(this)">Approve</button><button onclick="rejectSubmission(this)">Reject</button></td>`;
            pendingSubmissionsTable.appendChild(row);

            // Clear textarea
            solutionTextarea.value = '';
        }

        function approveSubmission(button) {
            const row = button.parentElement.parentElement;
            const submission = row.childNodes[1].textContent;
            const challengeId = row.childNodes[0].textContent;
            const approvedSolutionsDiv = document.getElementById(`approvedSolutions${challengeId}`);

            // Create user info div
            const userInfoDiv = document.createElement('div');
            userInfoDiv.classList.add('approved');
            userInfoDiv.innerHTML = `<strong>${userName}</strong>: ${submission} <span class="delete-btn" onclick="deleteSubmission(this)">üóëÔ∏è</span>`;
            approvedSolutionsDiv.appendChild(userInfoDiv);

            // Remove row from pending submissions
            row.remove();
        }

        function rejectSubmission(button) {
            const row = button.parentElement.parentElement;
            row.remove();
        }

        function deleteSubmission(button) {
            const userInfoDiv = button.parentElement;
            userInfoDiv.remove();
        }

        window.addEventListener('DOMContentLoaded', () => {
            const hash = window.location.hash;
            if (hash) {
                const token = hash.split('&')[0].split('=')[1];
                fetch('https://discord.com/api/users/@me', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                })
                .then(response => response.json())
                .then(data => {
                    userName = data.username; // Get the username
                    userPfp = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png`; // Get the profile picture URL
                    document.getElementById('userInfo').textContent = `Welcome, ${userName}!`;
                    document.getElementById('userInfo').style.display = 'block';
                    document.getElementById('userChallenges').textContent = `Your challenges will be displayed here, ${userName}.`;
                    document.getElementById('userChallenges').style.display = 'block';

                    // Check if the user is an admin
                    if (userName === adminUserName) {
                        isAdmin = true;
                        document.getElementById('adminNav').style.display = 'inline';
                        document.getElementById('admin').style.display = 'block'; // Show admin panel
                    }
                    document.querySelector('.user-info').innerHTML = `<img src="${userPfp}" alt="User Profile Picture"> ${userName}`;
                })
                .catch(error => {
                    console.error('Error fetching user data:', error);
                });
            }
        });

        function createChallenge() {
            const challengeName = prompt('Enter the challenge name:');
            const challengeDescription = prompt('Enter the challenge description:');
            if (challengeName && challengeDescription) {
                const challengeDiv = document.createElement('div');
                challengeDiv.classList.add('challenge');
                challengeDiv.innerHTML = `<h3>${challengeName}</h3><p>${challengeDescription}</p>`;
                document.getElementById('challenges').appendChild(challengeDiv);
            }
        }
    </script>
</body>

</html>
